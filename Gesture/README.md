# 智能盆栽动作识别系统

这是一个基于电脑摄像头的动作识别系统，能够识别以下动作：
- **挥手打招呼** → 输出 "Hi"
- **双手举高** → 输出 "Wow"
- **双手叉腰** → 输出 "Cool"
- **鼓掌** → 输出 "Good"
- **点头** → 输出 "Yes"
- **摇头** → 输出 "No"

## 技术方案

### 使用的库和模型
1. **MediaPipe Pose** - Google开发的免费姿态估计模型
   - 优点：轻量级、快速、准确
   - 完全免费，无需API密钥
   - 可以实时检测33个身体关键点

2. **OpenCV** - 计算机视觉库
   - 用于摄像头捕获和图像处理

3. **NumPy** - 数值计算库
   - 用于处理坐标和计算

### 动作识别原理

1. **挥手打招呼**
   - 检测手腕是否举起（高于肩膀）
   - 跟踪手腕的水平位置变化
   - 识别左右摆动模式

2. **双手举高**
   - 检测双手是否同时举起
   - 双手都要高于头部
   - 手肘也要抬起

3. **双手叉腰**
   - 检测双手是否在腰部/臀部位置
   - 手腕位置在肩膀和臀部之间
   - 双手靠近身体两侧

4. **鼓掌**
   - 检测双手在胸前位置
   - 跟踪双手距离的快速变化
   - 识别靠近-分开的重复模式

5. **点头**
   - 跟踪鼻子的垂直位置
   - 识别上下运动模式
   - 检测波峰和波谷

6. **摇头**
   - 跟踪鼻子的水平位置
   - 识别左右摆动模式
   - 检测方向变化

## 安装步骤

### 1. 安装Python
确保你的电脑上安装了Python 3.8或更高版本。

### 2. 安装依赖包
考虑到大家环境可能不一样，我推荐大家建造一个SmartPlanter环境再进行（可选）
```bash
conda create -n SmartPlanter python=3.11 -y

conda activate SmartPlanter
```

打开命令行（Windows: cmd 或 PowerShell，Mac: Terminal），进入项目文件夹，运行：

```bash
pip install -r requirements.txt
```

或者单独安装：
```bash
pip install opencv-python mediapipe numpy
```

## 运行程序

在项目文件夹中运行：

```bash
python gesture_recognition.py
```

## 使用说明

1. **启动程序后**，会打开摄像头窗口
2. **站在摄像头前**，确保上半身在画面中
3. **做出动作**：
   - **挥手**：举起一只手（高于肩膀），然后左右摆动
   - **双手举高**：双手同时向上举过头顶
   - **双手叉腰**：双手放在腰部两侧，保持1-2秒
   - **鼓掌**：双手在胸前拍手2-3次
   - **点头**：上下点头2-3次（已优化，更容易识别）
   - **摇头**：左右摇头2-3次（已优化阈值）

4. **查看结果**：
   - 窗口中会显示检测到的骨骼点
   - 识别到动作时会在窗口和控制台显示
   - 每个动作识别后有2秒冷却时间

5. **退出**：按键盘上的 'q' 键

## 调试建议

如果动作识别不准确，可以调整以下参数（在代码中）：

1. **灵敏度调整**
   - `min_detection_confidence`: 降低可提高检测率（默认0.5）
   - `min_tracking_confidence`: 降低可提高跟踪稳定性（默认0.5）

2. **动作阈值**
   - 挥手检测：`direction_changes >= 2`（可改为1）
   - 双手举高：手腕高度阈值可调整
   - 双手叉腰：手腕位置容差可调整
   - 鼓掌检测：`max_distance - min_distance > 80`（可降低阈值）
   - 点头检测：`movement_range < 8`（已优化，更容易触发）
   - 摇头检测：`movement_range < 25`（已调整，减少误触发）

3. **冷却时间**
   - `gesture_cooldown = 2.0`（可减少到1.0秒）

## 后续扩展

这个代码已经为盆栽系统做好准备：

1. **更换摄像头**
   - 将 `cv2.VideoCapture(0)` 改为盆栽摄像头的地址
   - 例如：`cv2.VideoCapture('http://盆栽IP:端口/video')`

2. **添加语音识别**
   - 可以集成 `speech_recognition` 库
   - 或使用 Google Speech API

3. **添加对话功能**
   - 可以集成 ChatGPT API 或其他对话模型
   - 使用 `pyttsx3` 进行语音合成

4. **添加更多动作**
   - 可以基于MediaPipe的33个关键点添加新动作
   - 例如：竖大拇指、V字手势、OK手势等

## 常见问题

**Q: 摄像头打不开？**
A: 检查摄像头权限，确保没有其他程序占用摄像头。

**Q: 识别不准确？**
A: 
- 确保光线充足
- 保持适当距离（1-2米）
- 动作要明显清晰
- 调整代码中的阈值参数

**Q: 程序运行慢？**
A: 
- 降低摄像头分辨率
- 调整MediaPipe的复杂度设置
- 关闭不必要的后台程序

## 系统要求

- Python 3.8+
- 摄像头（内置或外接）
- CPU: 建议i5或以上
- RAM: 至少4GB
- 操作系统: Windows 10/11, macOS, Linux

## 免费API和工具

本项目使用的所有库都是免费的：
- MediaPipe: 完全免费开源
- OpenCV: 免费开源
- NumPy: 免费开源

无需任何付费API或注册！
